<!DOCTYPE html>
<html>
<head>
	<!--  *****   Link To Custom CSS Style Sheet   *****  -->
	<link rel="stylesheet" type="text/css" href="GraphicDesign.css">

	<!--  *****   Link To Font Awsome Icons   *****  -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"/>

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Portfolio</title>
</head>
<body>

<section class="portfolio">
	
	<header class="section-head">
        <a href="/main/index.html"> <img src="/main/images/logo1.png" class="logo"></a>
		<a href="#" id="add-gallery-image" class="admin-btn"><img src="/main/images/add.png" class="add"></a>

		<h1> Design Gallery</h1>
	</header>

	<main class="mainContainer">
		
		<!--  *****  Buttons Section Starts  *****  -->
		<div class="button-group">
			<button class="button active" data-filter="*">All</button>
			<button class="button" data-filter=".design">Design</button>
		<button class="button" data-filter=".development">Development</button>
			<button class="button" data-filter=".logo">Logo</button>
		</div>
		<!--  *****  Buttons Section Ends  *****  -->

		<!--  *****  Gallery Section Starts  *****  -->
		<div id="gallery" class="gallery">
			
			<!--  *****  Card 1 Starts  *****  -->
			<div class="item development">
				<img src="/main/images/2.gif">
				<div class="overlay">
					
				</div>
			</div>
			<!--  *****  Card 1 Ends  *****  -->

			<!--  *****  Card 2 Starts  *****  -->
			<div class="item development">
				<img src="/main/images/2.gif">
				<div class="overlay">
					
				</div>
			</div>
			<!--  *****  Card 2 Ends  *****  -->

			<!--  *****  Card 3 Starts  *****  -->
			<div class="item development">
				<img src="/main/images/2.gif">
				<div class="overlay">
					
				</div>
			</div>
			<!--  *****  Card 3 Ends  *****  -->

            	<!--  *****  Card 4 Starts  *****  -->
			<div class="item design">
				<img src="/main/images/3.jpg">
				<div class="overlay">
				
				</div>
			</div>
			<!--  *****  Card 4 Ends  *****  -->

            	<!--  *****  Card 5 Starts  *****  -->
			<div class="item development">
				<img src="/main/images/`0.gif">
				<div class="overlay">
				
				</div>
			</div>
			<!--  *****  Card 5 Ends  *****  -->

            	<!--  *****  Card 6 Starts  *****  -->
			<div class="item design">
				<img src="/main/images/background.png">
				<div class="overlay">
				
				</div>
			</div>
			<!--  *****  Card 6 Ends  *****  -->
              
            	<!--  *****  Card 7 Starts  *****  -->
			<div class="item design">
				<img src="/main/images/6.jpg">
				<div class="overlay">
				
				</div>
			</div>
			<!--  *****  Card 7 Ends  *****  -->

            	<!--  *****  Card 8 Starts  *****  -->
			<div class="item development">
				<img src="/main/images/9.jpg">
				<div class="overlay">
					
				</div>
			</div>
			<!--  *****  Card 8 Ends  *****  -->

            <!--  *****  Card 9 Starts  *****  -->
			<div class="item design">
				<img src="/main/images/background2.jpg">
				<div class="overlay">
				
				</div>
			</div>
			<!--  *****  Card 9 Ends  *****  -->

                 <!--  *****  Card 10 Starts  *****  -->
			<div class="item design">
				<img src="/main/images/11.jpg">
				<div class="overlay">
				
				</div>
			</div>
			<!--  *****  Card 10 Ends  *****  -->

                 <!--  *****  Card 11 Starts  *****  -->
			<div class="item development">
				<img src="/main/images/8.gif">
				<div class="overlay">
					
				</div>
			</div>
			<!--  *****  Card 11 Ends  *****  -->

			 <!--  *****  Card 12 Starts  *****  -->
			 <div class="item logo">
				<img src="/main/images/ABYSS-2.png">
				<div class="overlay">
			
				</div>
			</div>
			<!--  *****  Card 12 Ends  *****  -->

			 <!--  *****  Card 13 Starts  *****  -->
			 <div class="item logo">
				<img src="/main/images/Abyss-logo-3.png">
				<div class="overlay">
					<a href="#">VIEW MORE</a>
				</div>
			</div>
			<!--  *****  Card 13 Ends  *****  -->

			 <!--  *****  Card 14 Starts  *****  -->
			 <div class="item logo">
				<img src="/main/images/logo1.png">
				<div class="overlay">
					<a href="#">VIEW MORE</a>
				</div>
			</div>
			<!--  *****  Card 14 Ends  *****  -->

		</div>
		<!--  *****  Gallery Section Ends  *****  -->

		<!-- Modal for Adding Gallery Images -->
		<div id="gallery-modal" class="modal">
			<div class="modal-content">
				<span class="close-button" id="close-gallery-modal">&times;</span>
				<h2>Add an Image to the Gallery</h2>
				<form id="gallery-form">
					<label for="gallery-image">Choose Image:</label>
					<input type="file" id="gallery-image" name="gallery-image" accept="image/*" required>
                    <select name="opt" id="opt">
                        <option value="design" class="item design">Design</option>
                        <option value="development" class="item development">Development</option>
                        <option value="logo" class="item logo">Logo</option>
                    </select>
					<button type="submit">Add Image</button>
				</form>
			</div>
		</div>

	</main>

</section>


<!--   *****   JQuery Link   *****   -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>

<!--   *****   Isotope Filter Link   *****  -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js"></script>

<!-- <script type="text/javascript">
	var $galleryContainer = $('.gallery').isotope({
		itemSelector: '.item',
  		layoutMode: 'fitRows'
	})

	$('.button-group .button').on('click', function(){
		$('.button-group .button').removeClass('active');
		$(this).addClass('active');

		var value = $(this).attr('data-filter');
		$galleryContainer.isotope({
			filter: value 
		})
	})
</script> -->

  <!-- Custom Scripts -->
  <script type="text/javascript">
	// Initialize Isotope after images are loaded
	var $galleryContainer = $('.gallery');

	$galleryContainer.imagesLoaded(function () {
		$galleryContainer.isotope({
			itemSelector: '.item',
			layoutMode: 'fitRows'
		}).addClass('isotope-ready');
	});

	// Filter buttons
	$('.button-group .button').on('click', function () {
		$('.button-group .button').removeClass('active');
		$(this).addClass('active');

		var value = $(this).attr('data-filter');
		$galleryContainer.isotope({ filter: value });
	});
</script>

<script>
	// Get elements for the project modal
	const galleryModal = document.getElementById('gallery-modal');
	const galleryButton = document.getElementById('add-gallery-image');
	const closeGalleryModal = document.getElementById('close-gallery-modal');
	
	// Open the project modal
	galleryButton?.addEventListener('click', (e) => {
		e.preventDefault();
		galleryModal.style.display = 'block';
	});
	
	// Close the project modal
	closeGalleryModal.addEventListener('click', () => {
		galleryModal.style.display = 'none';
	});
	
	// Close the modal when clicking outside it
	window.addEventListener('click', (e) => {
		if (e.target === galleryModal) {
			galleryModal.style.display = 'none';
		}
	});
	
	// Handle the project form submission
	const galleryForm = document.getElementById('gallery-form');
	const galleryImageInput = document.getElementById('gallery-image');
	const galleryCategoryInput = document.getElementById('opt');
	
	galleryForm.addEventListener('submit', async (e) => {
		e.preventDefault(); // Prevent form from refreshing the page
	
		// Get form values
		const file = galleryImageInput.files[0];
		const imgCategory = galleryCategoryInput.value;
	
		if (file && imgCategory) {
			const formData = new FormData();
			formData.append('image', file);
			formData.append('category', imgCategory);
	
			try {
				// Send data to the backend
				const response = await fetch('http://localhost:5000/gallery', {
					method: 'POST',
					body: formData,
				});
	
				if (response.ok) {
					const project = await response.json(); // Response from the backend
	
					// Add images to UI dynamically
					const newGalleryImg = document.createElement('div');
					newGalleryImg.className = `item ${imgCategory}`;
	
					const newGalleryItem = $(`
                    <div class="item ${project.gallery.category}">
                        <img src="http://localhost:5000/uploads/${project.gallery.image}" alt="${project.gallery.category}">
                        <div class="overlay">
                            <a href="#">VIEW MORE</a>
                        </div>
                    </div>
                `);

                const $galleryContainer = $('.gallery');
                $galleryContainer.append(newGalleryItem);

                // Trigger Isotope to recognize the new item
                $galleryContainer.imagesLoaded(() => {
                    $galleryContainer.isotope('reloadItems').isotope('layout');
                });

                galleryImageInput.value = '';
                galleryModal.style.display = 'none';


					// newGalleryImg.innerHTML = `
					// 	<img src="http://localhost:5000/uploads/${project.i}" alt="${project.category}">
					// 	 <div class="overlay">
                    // 		<a href="#">VIEW MORE</a>
                	// 	</div>
					// `;
	
					// // Add the new project to the grid
					// document.querySelector('#gallery').appendChild(newGalleryImg);

					// // Trigger Isotope to re-layout after adding a new item
					// $galleryContainer.isotope('reloadItems').isotope('layout');
	
					// // Clear the input fields and close the modal
					// galleryImageInput.value = '';
					// galleryModal.style.display = 'none';
				} else {
					alert('Error saving project. Please try again.');
				}
			} catch (error) {
				console.error('Error:', error);
				alert('An error occurred while saving the project.');
			}
		} else {
			alert('Please provide both a project name and an image.');
		}
	});
	
	// Function to load projects from the backend
	async function loadProjects() {
		try {
			const response = await fetch('http://localhost:5000/gallery');
			if (response.ok) {
				const galleryImages = await response.json();
	
				// Add each project to the grid
				galleryImages.forEach((project) => {
					const galleryItem = document.createElement('div');
					galleryItem.className = `item ${project.category}`;
	
					galleryItem.innerHTML = `
						 <img src="http://localhost:5000/uploads/${project.image}" alt="${project.category}">
                        <div class="overlay">
                            <a href="#">VIEW MORE</a>
                        </div>
					`;
						$galleryContainer.append(galleryItem);

						  // Wait for all images to load before refreshing Isotope
						  $galleryContainer.imagesLoaded(() => {
                $galleryContainer.isotope('reloadItems').isotope('layout');
            });
				});
			} else {
				console.error('Failed to load projects');
			}
		} catch (error) {
			console.error('Error:', error);
		}
	}
	
	// Load projects when the page loads
	window.addEventListener('DOMContentLoaded', loadProjects);
	
	</script>
<!-- <script>
    // Get elements for the gallery modal
    const galleryModal = document.getElementById('gallery-modal');
    const galleryButton = document.getElementById('add-gallery-image');
    const closeGalleryModal = document.getElementById('close-gallery-modal');
    const galleryCategoryInput = document.getElementById('opt');
    const galleryForm = document.getElementById('gallery-form');
    const galleryInput = document.getElementById('gallery-image');
    
    // Open the gallery modal
    galleryButton.addEventListener('click', (e) => {
        e.preventDefault();
        galleryModal.style.display = 'block';
    });
    
    // Close the gallery modal
    closeGalleryModal.addEventListener('click', () => {
        galleryModal.style.display = 'none';
    });
    
    // Close the modal when clicking outside it
    window.addEventListener('click', (e) => {
        if (e.target === galleryModal) {
            galleryModal.style.display = 'none';
        }
    });
    
    galleryForm.addEventListener('submit', async (e) => {
    e.preventDefault(); // Prevent form from refreshing the page

    // Get the uploaded file and category
    const file = galleryInput.files[0];
    const category = galleryCategoryInput.value;

    if (file && category) {
        const formData = new FormData();
        formData.append('image', file);
        formData.append('category', category);

        try {
            // Send data to the backend
            const response = await fetch('http://localhost:5000/gallery', {
                method: 'POST',
                body: formData,
            });

            if (response.ok) {
                const project = await response.json(); // Response from the backend

                // Log the response to see if it contains the correct image URL
                console.log(project);

                // Check if the response contains the image URL
                if (project && project.imageUrl) {
                    // Create a new gallery item
                    const newItem = document.createElement('div');
                    newItem.className = `item ${category.toLowerCase()}`; // Add category as a class
                    newItem.innerHTML = `
                        <img src="${project.imageUrl}" alt="New Gallery Image">
                        <div class="overlay">
                            <a href="#">VIEW MORE</a>
                        </div>
                    `;

                    // Add the new item to the gallery
                    const galleryContainer = document.querySelector('.gallery');
                    galleryContainer.appendChild(newItem);

                    // Refresh Isotope to include the new item
                    if (window.$galleryContainer) {
                        $galleryContainer.isotope('appended', newItem);
                    }

                    // Clear the input and close the modal
                    galleryInput.value = '';
                    galleryModal.style.display = 'none';
                } else {
                    alert('Error: Image URL not returned from the server.');
                }
            } else {
                alert('Error saving project. Please try again.');
            }
        } catch (error) {
            console.error('Error:', error);
            alert('An error occurred while saving the project.');
        }
    } else {
        alert('Please provide both a project name and an image.');
    }
});

// Function to load projects from the backend
async function loadGallery() {
    try {
        const response = await fetch('http://localhost:5000/gallery');
        if (response.ok) {
            const gallerys = await response.json();

            // Add each project to the grid
           gallerys.forEach((gallery) => {
                const galleryItem = document.createElement('div');
                galleryItem.className = 'gallery-item';

                galleryItem.innerHTML = `
                        <img src="${gallery.imageUrl}" alt="New Gallery Image">
                        <div class="overlay">
                            <a href="#">VIEW MORE</a>
                        </div>
                    `;
                document.querySelector('.gallery').appendChild(galleryItem);
            });
        } else {
            console.error('Failed to load projects');
        }
    } catch (error) {
        console.error('Error:', error);
    }
}
   
    </script> -->
</body>
</html>